<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Turi Create: turi::sketches::streaming_quantile_sketch&lt; T, Comparator &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Turi Create
   &#160;<span id="projectnumber">4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classturi_1_1sketches_1_1streaming__quantile__sketch.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classturi_1_1sketches_1_1streaming__quantile__sketch-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">turi::sketches::streaming_quantile_sketch&lt; T, Comparator &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__sketching.html">Sketching Datastructures and Algorithms</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="streaming__quantile__sketch_8hpp_source.html">ml/sketches/streaming_quantile_sketch.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afa9c19075176f234d4297c275c6d7873"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#afa9c19075176f234d4297c275c6d7873">streaming_quantile_sketch</a> (double epsilon=0.005, const Comparator &amp;comparator=Comparator())</td></tr>
<tr class="separator:afa9c19075176f234d4297c275c6d7873"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab78cb0331e650f2e800300c61edcbf16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ab78cb0331e650f2e800300c61edcbf16">init</a> (double epsilon, const Comparator &amp;comparator)</td></tr>
<tr class="separator:ab78cb0331e650f2e800300c61edcbf16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a176a093e626a9cb0fad99123734ff638"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a176a093e626a9cb0fad99123734ff638">sketch_size</a> ()</td></tr>
<tr class="separator:a176a093e626a9cb0fad99123734ff638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd7042e123872ecb9a6993ae5cb7fee"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a0dd7042e123872ecb9a6993ae5cb7fee">memory_usage</a> ()</td></tr>
<tr class="separator:a0dd7042e123872ecb9a6993ae5cb7fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f1a923cd3b2a756a2468018a2f572e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a29f1a923cd3b2a756a2468018a2f572e">add</a> (T t)</td></tr>
<tr class="separator:a29f1a923cd3b2a756a2468018a2f572e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac47bfb1d56fcebcaa4ebb21564a1891f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac47bfb1d56fcebcaa4ebb21564a1891f">finalize</a> ()</td></tr>
<tr class="separator:ac47bfb1d56fcebcaa4ebb21564a1891f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4662c34ccfb634623e1ed44bfea39f2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac4662c34ccfb634623e1ed44bfea39f2">size</a> () const</td></tr>
<tr class="separator:ac4662c34ccfb634623e1ed44bfea39f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3c7cd3f4700ad7e34a1aa989ceecbd0"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ad3c7cd3f4700ad7e34a1aa989ceecbd0">query</a> (size_t rank)</td></tr>
<tr class="separator:ad3c7cd3f4700ad7e34a1aa989ceecbd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe1017a878bcaddf2563aa1127fe071b"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#afe1017a878bcaddf2563aa1127fe071b">query_quantile</a> (double quantile)</td></tr>
<tr class="separator:afe1017a878bcaddf2563aa1127fe071b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ee1213112eae36268550508588022ef"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a9ee1213112eae36268550508588022ef">fast_query</a> (size_t rank)</td></tr>
<tr class="separator:a9ee1213112eae36268550508588022ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5e6015a521c912b08af79de8df2007a"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ab5e6015a521c912b08af79de8df2007a">fast_query_quantile</a> (double quantile)</td></tr>
<tr class="separator:ab5e6015a521c912b08af79de8df2007a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73aa96ce21c702683f43b9efef052ef9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a73aa96ce21c702683f43b9efef052ef9">substream_finalize</a> ()</td></tr>
<tr class="separator:a73aa96ce21c702683f43b9efef052ef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2821c9c5983710f18f8aede9b310afe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac2821c9c5983710f18f8aede9b310afe">combine</a> (<a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">streaming_quantile_sketch</a> other)</td></tr>
<tr class="separator:ac2821c9c5983710f18f8aede9b310afe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ca525480498482ce9c849596d46b243"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a0ca525480498482ce9c849596d46b243">combine_finalize</a> ()</td></tr>
<tr class="separator:a0ca525480498482ce9c849596d46b243"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename T, typename Comparator&gt;<br />
class turi::sketches::streaming_quantile_sketch&lt; T, Comparator &gt;</h3>

<p>This class implements the <em>streaming</em> quantile sketching datastructure as described in Qi Zhang and Wei Wang. A Fast Algorithm for Approximate Quantiles in High Speed Data Streams. SSDBM 2007.</p>
<p>This sketch is basically a streaming version of the <a class="el" href="classturi_1_1sketches_1_1quantile__sketch.html">quantile_sketch</a></p>
<p>It constructs a low memory sketch from a stream of unknown length. To summarize the basic idea, it draws samples from the stream and maintains for each sample a lower bound and an upper bound on its rank in the stream.</p>
<p>Usage: </p><div class="fragment"><div class="line"><span class="comment">// construct a sketch at a particular accuracy</span></div><div class="line">quantile_sketch&lt;double&gt; sketch(0.01);</div><div class="line">...</div><div class="line">insert any number elements into the sketch</div><div class="line">sketch.add(value)</div><div class="line">...</div><div class="line">sketch.finalize() <span class="comment">// finalize must be called before queries can be made</span></div></div><!-- fragment --><p>To query, two family of functions are provided.</p>
<p>The regular query functions take linear time in the size of the sketch, and have accuracy guarantees </p><div class="fragment"><div class="line">sketch.query(rank) <span class="comment">// rank is between [0, N-1]</span></div><div class="line">sketch.query_quantile(quantile) <span class="comment">// quantile is between [0, 1.0]</span></div></div><!-- fragment --><p>The fast query functions take logarithmic time in the size of the sketch, and have no accuracy guarantees. </p><div class="fragment"><div class="line">sketch.fast_query(rank) <span class="comment">// rank is between [0, N-1]</span></div><div class="line">sketch.fast_query_quantile(quantile) <span class="comment">// quantile is between [0, 1.0]</span></div></div><!-- fragment --><p>The sketch structure also support parallel sketching:</p>
<p>Example: If I have 16 data streams, I can construct 16 streaming_quantile_sketches:</p>
<p>Each sketch can then be ran on each data stream independently. Then all can be combined into one. Note that the process for doing this on the <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">streaming_quantile_sketch</a> is somewhat more complicated. It involves a partial finalization of each substream (sub_stream_finalize() ), before combining. And after combining, a different finalization call must be made (<a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a0ca525480498482ce9c849596d46b243">combine_finalize()</a>)</p>
<div class="fragment"><div class="line"><span class="comment">// add stuff to each sub stream</span></div><div class="line"><span class="keywordflow">for each</span> sub-stream sketch:</div><div class="line">  sub-stream-sketch.add(...)</div><div class="line"></div><div class="line"><span class="comment">// pre-finalize each sub stream</span></div><div class="line"><span class="keywordflow">for each</span> sub-stream sketch:</div><div class="line">  sub-stream-sketch.substream_finalize();</div><div class="line"></div><div class="line"><span class="comment">// combine into one sketch</span></div><div class="line">quantile_sketch sketch(0.01)</div><div class="line">for each sub-stream sketch:</div><div class="line">  sketch.<a class="code" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac2821c9c5983710f18f8aede9b310afe">combine</a>(sub-stream-sketch)</div><div class="line"></div><div class="line"><span class="comment">// finalize the main sketch</span></div><div class="line">sketch.<a class="code" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a0ca525480498482ce9c849596d46b243">combine_finalize</a>()</div></div><!-- fragment --><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Type</td><td>to contain in the sketch. type must be less-than-comparable, constructible, copy constructible, assignable.</td></tr>
  </table>
  </dd>
</dl>
<h2>Technical Details </h2>
<p>We create a sequence of fixed length sketches, with each subsequent sketch sized to sketch twice the amount of data as the previous one. Each sketch is built to have a final finalized error of  / 3.</p>
<p>If no sub-streams are used, the <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac47bfb1d56fcebcaa4ebb21564a1891f">finalize()</a> phase will merge all sketches and recompress to introduce an additional error of (2 *  / 3)</p>
<p>If sub-streams are used, the sub-stream finalize will merge all the sub-stream sketches to introduce an additional error of ( / 3). Then each of the substream sketches are merged into the final sketch and compressed again to introduce an additional error of ( / 3) </p>

<p class="definition">Definition at line <a class="el" href="quantile__sketch_8hpp_source.html#l00022">22</a> of file <a class="el" href="quantile__sketch_8hpp_source.html">quantile_sketch.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afa9c19075176f234d4297c275c6d7873"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa9c19075176f234d4297c275c6d7873">&#9670;&nbsp;</a></span>streaming_quantile_sketch()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::<a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">streaming_quantile_sketch</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>0.005</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Comparator &amp;&#160;</td>
          <td class="paramname"><em>comparator</em> = <code>Comparator()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs a <a class="el" href="classturi_1_1sketches_1_1quantile__sketch.html">quantile_sketch</a> with a desired target number of elements, and a desired accuracy. See <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ab78cb0331e650f2e800300c61edcbf16">init()</a> for details. </p>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00110">110</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a29f1a923cd3b2a756a2468018a2f572e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29f1a923cd3b2a756a2468018a2f572e">&#9670;&nbsp;</a></span>add()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::add </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Inserts a value into the sketch. Not safe to use in parallel. </p>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00163">163</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="ac2821c9c5983710f18f8aede9b310afe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2821c9c5983710f18f8aede9b310afe">&#9670;&nbsp;</a></span>combine()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::combine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">streaming_quantile_sketch</a>&lt; T, Comparator &gt;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Merges two substream_finalized <a class="el" href="classturi_1_1sketches_1_1quantile__sketch.html">quantile_sketch</a> into one quantile sketch. Both this and the other quantile sketch must be substream_finalized(). This allows two quantile sketches to be generated on two disjoint streams of data, and then combined at the end.</p>
<p>Example: If I have 16 data streams, I can construct 16 quantile_sketches,</p>
<p>Each sketch can then be ran on each data stream independently. Then all can be combined into one:</p>
<div class="fragment"><div class="line"><span class="comment">// add stuff to each sub stream</span></div><div class="line"><span class="keywordflow">for each</span> sub-stream sketch:</div><div class="line">  sub-stream-sketch.add(...)</div><div class="line"></div><div class="line"><span class="comment">// pre-finalize each sub stream</span></div><div class="line"><span class="keywordflow">for each</span> sub-stream sketch:</div><div class="line">  sub-stream-sketch.substream_finalize();</div><div class="line"></div><div class="line"><span class="comment">// combine into one sketch</span></div><div class="line">quantile_sketch sketch(0.01)</div><div class="line">for each sub-stream sketch:</div><div class="line">  sketch.<a class="code" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac2821c9c5983710f18f8aede9b310afe">combine</a>(sub-stream-sketch)</div><div class="line"></div><div class="line"><span class="comment">// finalize the main sketch</span></div><div class="line">sketch.<a class="code" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a0ca525480498482ce9c849596d46b243">combine_finalize</a>()</div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The predictions produced by the combined sketch is not generally going to be the same as the sequentially produced sketch</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a0ca525480498482ce9c849596d46b243">combine_finalize()</a> <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a73aa96ce21c702683f43b9efef052ef9">substream_finalize()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00377">377</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="a0ca525480498482ce9c849596d46b243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ca525480498482ce9c849596d46b243">&#9670;&nbsp;</a></span>combine_finalize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::combine_finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Stops combining, and finishes the final sketch making it available for querying. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac2821c9c5983710f18f8aede9b310afe">combine()</a> <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a73aa96ce21c702683f43b9efef052ef9">substream_finalize()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00390">390</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="a9ee1213112eae36268550508588022ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ee1213112eae36268550508588022ef">&#9670;&nbsp;</a></span>fast_query()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::fast_query </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>rank</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Quickly queries for the value at rank k of all the elements inserted. Assuming N elements are inserted. Rank 0 will be the minimum value, rank N-1, the maximum value.</p>
<p>Note that this rank is in relation to the total number of elements inserted. For instance, </p><div class="fragment"><div class="line">quantile_sketch&lt;double&gt; sketch(1000);</div><div class="line">...</div><div class="line">insert 10,000 elements into the sketch</div></div><!-- fragment --><p> sketch.fast_query(9999) will be the maximum.</p>
<p>Unlike <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ad3c7cd3f4700ad7e34a1aa989ceecbd0">query()</a>, this function is never guaranteed to provide an epsilon error bound. Instead, this function assumes that each element in the sketch has a point estimate of its rank (the center of its rmin/rmax range), and looks for the element closest to the desired rank.</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac47bfb1d56fcebcaa4ebb21564a1891f">finalize()</a> must be called prior to using this function.</dd>
<dd>
The complexity of this function can be logarithmic in the sketch size in the best case (appears to be all the time, empirically), or linear in the worst case. Essentially, it first tests the result of the fast_query to see if that fits the bound requirements. If it does not, it takes a full linear search. The fast_query seems to work pretty much all the time on randomized inputs of varying distributions. </dd></dl>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00286">286</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="ab5e6015a521c912b08af79de8df2007a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5e6015a521c912b08af79de8df2007a">&#9670;&nbsp;</a></span>fast_query_quantile()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::fast_query_quantile </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>quantile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Quickly returns the value at a quantile. For instance: </p><div class="fragment"><div class="line">sketch.fast_query_quantile(0.01) <span class="comment">// returns the 1% quantile</span></div><div class="line">sketch.fast_query_quantile(0.50) <span class="comment">// returns the median</span></div><div class="line">sketch.fast_query_quantile(1.00) <span class="comment">// returns the max</span></div></div><!-- fragment --><p>quantile values below 0 will be interpreted as 0 (hence the minimum). quantile values above 1 will be interpreted as 1 (hence the maximum).</p>
<p>Unlike <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#afe1017a878bcaddf2563aa1127fe071b">query_quantile()</a>, this function is never guaranteed to provide an epsilon error bound. Instead, this function assumes that each element in the sketch has a point estimate of its rank (the center of its rmin/rmax range), and looks for the element closest to the desired rank.</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac47bfb1d56fcebcaa4ebb21564a1891f">finalize()</a> must be called prior to using this function.</dd>
<dd>
The complexity of this function is logarithmic in the sketch size. </dd></dl>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00311">311</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="ac47bfb1d56fcebcaa4ebb21564a1891f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac47bfb1d56fcebcaa4ebb21564a1891f">&#9670;&nbsp;</a></span>finalize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Finalizes the sketch datastructure. Must be called before queries are made. Once <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac47bfb1d56fcebcaa4ebb21564a1891f">finalize()</a> is called, elements may no longer be inserted. </p>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00182">182</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="ab78cb0331e650f2e800300c61edcbf16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab78cb0331e650f2e800300c61edcbf16">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::init </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Comparator &amp;&#160;</td>
          <td class="paramname"><em>comparator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reinitializes the quantile sketch, resetting it. epsilon is the desired accuracy of the quantiles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">epsilon</td><td>The desired accuracy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00121">121</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="a0dd7042e123872ecb9a6993ae5cb7fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dd7042e123872ecb9a6993ae5cb7fee">&#9670;&nbsp;</a></span>memory_usage()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::memory_usage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the approximate current memory usage of the sketch in bytes. </p>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00151">151</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="ad3c7cd3f4700ad7e34a1aa989ceecbd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3c7cd3f4700ad7e34a1aa989ceecbd0">&#9670;&nbsp;</a></span>query()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::query </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>rank</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Queries for the value at rank k of all the elements inserted. Assuming N elements are inserted. Rank 0 will be the minimum value, rank N-1, the maximum value.</p>
<p>Note that this rank is in relation to the total number of elements inserted. For instance, </p><div class="fragment"><div class="line">quantile_sketch&lt;double&gt; sketch(1000);</div><div class="line">...</div><div class="line">insert 10,000 elements into the sketch</div></div><!-- fragment --><p> sketch.query(9999) will be the maximum.</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac47bfb1d56fcebcaa4ebb21564a1891f">finalize()</a> must be called prior to using this function.</dd>
<dd>
The complexity of this function can be logarithmic in the sketch size in the best case (appears to be all the time, empirically), or linear in the worst case. Essentially, it first tests the result of the fast_query to see if that fits the bound requirements. If it does not, it takes a full linear search. The fast_query seems to work pretty much all the time on randomized inputs of varying distributions. </dd></dl>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00234">234</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="afe1017a878bcaddf2563aa1127fe071b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe1017a878bcaddf2563aa1127fe071b">&#9670;&nbsp;</a></span>query_quantile()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::query_quantile </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>quantile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the value at a quantile. For instance: </p><div class="fragment"><div class="line">sketch.query_quantile(0.01) <span class="comment">// returns the 1% quantile</span></div><div class="line">sketch.query_quantile(0.50) <span class="comment">// returns the median</span></div><div class="line">sketch.query_quantile(1.00) <span class="comment">// returns the max</span></div></div><!-- fragment --><p>quantile values below 0 will be interpreted as 0 (hence the minimum). quantile values above 1 will be interpreted as 1 (hence the maximum).</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac47bfb1d56fcebcaa4ebb21564a1891f">finalize()</a> must be called prior to using this function.</dd>
<dd>
The complexity of this function is linear in the sketch size. </dd></dl>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00254">254</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="ac4662c34ccfb634623e1ed44bfea39f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4662c34ccfb634623e1ed44bfea39f2">&#9670;&nbsp;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the number of elements inserted into the sketch. </p>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00207">207</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="a176a093e626a9cb0fad99123734ff638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a176a093e626a9cb0fad99123734ff638">&#9670;&nbsp;</a></span>sketch_size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::sketch_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the number of elements stored in the sketch </p>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00138">138</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<a id="a73aa96ce21c702683f43b9efef052ef9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73aa96ce21c702683f43b9efef052ef9">&#9670;&nbsp;</a></span>substream_finalize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename Comparator&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">turi::sketches::streaming_quantile_sketch</a>&lt; T, Comparator &gt;::substream_finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Finalizes the sketch datastructure, in preparation for combining with other streaming quantile sketches. Once <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a73aa96ce21c702683f43b9efef052ef9">substream_finalize()</a> is called, elements may no longer be inserted.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#a0ca525480498482ce9c849596d46b243">combine_finalize()</a> <a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html#ac2821c9c5983710f18f8aede9b310afe">combine()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="streaming__quantile__sketch_8hpp_source.html#l00323">323</a> of file <a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ml/sketches/<a class="el" href="quantile__sketch_8hpp_source.html">quantile_sketch.hpp</a></li>
<li>ml/sketches/<a class="el" href="streaming__quantile__sketch_8hpp_source.html">streaming_quantile_sketch.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceturi.html">turi</a></li><li class="navelem"><b>sketches</b></li><li class="navelem"><a class="el" href="classturi_1_1sketches_1_1streaming__quantile__sketch.html">streaming_quantile_sketch</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
