<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Turi Create: turi::shmipc::server Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Turi Create
   &#160;<span id="projectnumber">4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classturi_1_1shmipc_1_1server.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classturi_1_1shmipc_1_1server-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">turi::shmipc::server Class Reference<div class="ingroups"><a class="el" href="group__shmipc.html">Shared Memory Interprocess Communication</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="shmipc_8hpp_source.html">core/system/platform/shmipc/shmipc.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af0ec42582be1fc3bb3ae59a9df1ab008"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1shmipc_1_1server.html#af0ec42582be1fc3bb3ae59a9df1ab008">bind</a> (const std::string &amp;ipcfile=&quot;&quot;, size_t <a class="el" href="classturi_1_1shmipc_1_1server.html#a67fa88a348665ad0fc5824a1cd4c302a">buffer_size</a>=1024 *1024)</td></tr>
<tr class="separator:af0ec42582be1fc3bb3ae59a9df1ab008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67fa88a348665ad0fc5824a1cd4c302a"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1shmipc_1_1server.html#a67fa88a348665ad0fc5824a1cd4c302a">buffer_size</a> () const </td></tr>
<tr class="separator:a67fa88a348665ad0fc5824a1cd4c302a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dba4b05e2b4828c423e41afc9e58ec1"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1shmipc_1_1server.html#a7dba4b05e2b4828c423e41afc9e58ec1">get_shared_memory_name</a> () const </td></tr>
<tr class="separator:a7dba4b05e2b4828c423e41afc9e58ec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa836cdfd8c4b0e54bd5b1f77ec401214"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1shmipc_1_1server.html#aa836cdfd8c4b0e54bd5b1f77ec401214">wait_for_connect</a> (size_t timeout=10)</td></tr>
<tr class="separator:aa836cdfd8c4b0e54bd5b1f77ec401214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8f27e4945e61deae14e99085b98dd6d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1shmipc_1_1server.html#af8f27e4945e61deae14e99085b98dd6d">send</a> (const char *c, size_t len)</td></tr>
<tr class="separator:af8f27e4945e61deae14e99085b98dd6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d2675ca441ba1f95c5b81f97e8bfe02"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1shmipc_1_1server.html#a0d2675ca441ba1f95c5b81f97e8bfe02">receive</a> (char **c, size_t *clen, size_t &amp;receivelen, size_t timeout)</td></tr>
<tr class="separator:a0d2675ca441ba1f95c5b81f97e8bfe02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a365ea3b995cdbc9450dfa190e4d245cf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1shmipc_1_1server.html#a365ea3b995cdbc9450dfa190e4d245cf">receive_direct</a> (char **c, size_t *len, size_t &amp;receivelen, size_t timeout)</td></tr>
<tr class="separator:a365ea3b995cdbc9450dfa190e4d245cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa4eb674cc6165fda0350f9e27711c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1shmipc_1_1server.html#a8aa4eb674cc6165fda0350f9e27711c7">shutdown</a> ()</td></tr>
<tr class="separator:a8aa4eb674cc6165fda0350f9e27711c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The SHM IPC server/client defines a simple unsynchronized single server / single client communication system over interprocess shared memory.</p>
<p>The communication is mostly unsynchronized between server and client, so users of the server/client implementations have to be careful about who is sending and who is receiving.</p>
<p>The class uses Posix Shared Memory segments. Essentially you define a "name" (on Linux this name shows up in /dev/shm, on Mac this is unfortunately not enumerable).</p>
<p>Within the shared memory segment is essentially a buffer, and a pair of condition variables used to wake a client receiver, or a server receiver.</p>
<p>The server creates a name, and a size and waits for a client to connect to it. Once a client connects, the shared memory segment is deleted (unlink). This means that once both server and client terminate (or crash), the shared memory segment is released. (otherwise the named segment will hang around until a reboot).</p>
<p>However, this does mean that program crash prior to connection can result in leaked segments. And that is bad. Hence we need a "garbage collection" mechanism. </p>

<p>Definition at line <a class="el" href="shmipc_8hpp_source.html#l00049">49</a> of file <a class="el" href="shmipc_8hpp_source.html">shmipc.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="af0ec42582be1fc3bb3ae59a9df1ab008"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool turi::shmipc::server::bind </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ipcfile</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buffer_size</em> = <code>1024&#160;*1024</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Binds a server to an ipc name. This SHM name will show up in /dev/shm on linux machines. Every server must bind to a different file. If ipcfile is an empty string, a file is automatically constructed and <a class="el" href="classturi_1_1shmipc_1_1server.html#a7dba4b05e2b4828c423e41afc9e58ec1">get_shared_memory_name()</a> can be used to get the shared memory name. </p>

</div>
</div>
<a class="anchor" id="a67fa88a348665ad0fc5824a1cd4c302a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t turi::shmipc::server::buffer_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the maximum amount of data that can be sent or received. </p>

</div>
</div>
<a class="anchor" id="a7dba4b05e2b4828c423e41afc9e58ec1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string turi::shmipc::server::get_shared_memory_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the shared memory object name. </p>

</div>
</div>
<a class="anchor" id="a0d2675ca441ba1f95c5b81f97e8bfe02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool turi::shmipc::server::receive </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>clen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>receivelen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Receives a bunch of bytes into (*c) and (*clen). (*c) and (*clen) may be resized as required to fit the data. if c == nullptr and clen == nullptr, the return data is discarded. </p>

</div>
</div>
<a class="anchor" id="a365ea3b995cdbc9450dfa190e4d245cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool turi::shmipc::server::receive_direct </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>receivelen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>receives a direct buffer to the data. It is up to the caller to make sure that no other sends/receives happen while the caller accesses the data. </p>

</div>
</div>
<a class="anchor" id="af8f27e4945e61deae14e99085b98dd6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool turi::shmipc::server::send </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sends a bunch of bytes. </p>

</div>
</div>
<a class="anchor" id="a8aa4eb674cc6165fda0350f9e27711c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void turi::shmipc::server::shutdown </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>shutsdown the server </p>

</div>
</div>
<a class="anchor" id="aa836cdfd8c4b0e54bd5b1f77ec401214"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool turi::shmipc::server::wait_for_connect </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>timeout</em> = <code>10</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Waits up to timeout seconds for a connection. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>core/system/platform/shmipc/<a class="el" href="shmipc_8hpp_source.html">shmipc.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceturi.html">turi</a></li><li class="navelem"><b>shmipc</b></li><li class="navelem"><a class="el" href="classturi_1_1shmipc_1_1server.html">server</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
