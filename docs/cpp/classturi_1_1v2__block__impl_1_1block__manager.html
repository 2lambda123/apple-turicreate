<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Turi Create: turi::v2_block_impl::block_manager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Turi Create
   &#160;<span id="projectnumber">4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classturi_1_1v2__block__impl_1_1block__manager.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classturi_1_1v2__block__impl_1_1block__manager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">turi::v2_block_impl::block_manager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="sarray__v2__block__manager_8hpp_source.html">core/storage/sframe_data/sarray_v2_block_manager.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3710c16eed8f76ee74078940a20dc94d"><td class="memItemLeft" align="right" valign="top"><a id="a3710c16eed8f76ee74078940a20dc94d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a3710c16eed8f76ee74078940a20dc94d">block_manager</a> ()</td></tr>
<tr class="memdesc:a3710c16eed8f76ee74078940a20dc94d"><td class="mdescLeft">&#160;</td><td class="mdescRight">default constructor. <br /></td></tr>
<tr class="separator:a3710c16eed8f76ee74078940a20dc94d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2f22a722c480ce6f1f6e709d1cdf425"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceturi_1_1v2__block__impl.html#a94d78bcd851eb06af0bf8129da9b5c3b">column_address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#ad2f22a722c480ce6f1f6e709d1cdf425">open_column</a> (std::string column_file)</td></tr>
<tr class="separator:ad2f22a722c480ce6f1f6e709d1cdf425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a894aaa104dc1754a35df2d1ac6184944"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a894aaa104dc1754a35df2d1ac6184944">close_column</a> (<a class="el" href="namespaceturi_1_1v2__block__impl.html#a94d78bcd851eb06af0bf8129da9b5c3b">column_address</a> addr)</td></tr>
<tr class="separator:a894aaa104dc1754a35df2d1ac6184944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8203a24889f963b966c94fd57b1bbbc9"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a8203a24889f963b966c94fd57b1bbbc9">num_blocks_in_column</a> (<a class="el" href="namespaceturi_1_1v2__block__impl.html#a94d78bcd851eb06af0bf8129da9b5c3b">column_address</a> addr)</td></tr>
<tr class="separator:a8203a24889f963b966c94fd57b1bbbc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb0042d6368f838c248e04ef4ea8a5f6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#aeb0042d6368f838c248e04ef4ea8a5f6">get_block_info</a> (<a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a> addr)</td></tr>
<tr class="separator:aeb0042d6368f838c248e04ef4ea8a5f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2676147bf68a5b4e4ea8cb00eaf56fdb"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::vector&lt; <a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a2676147bf68a5b4e4ea8cb00eaf56fdb">get_all_block_info</a> (size_t segment_id)</td></tr>
<tr class="separator:a2676147bf68a5b4e4ea8cb00eaf56fdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61af9c7af7d6fe9a746d4852e2370d24"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; std::vector&lt; char &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a61af9c7af7d6fe9a746d4852e2370d24">read_block</a> (<a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a> addr, <a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> **ret_info=NULL)</td></tr>
<tr class="separator:a61af9c7af7d6fe9a746d4852e2370d24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f43a7b44bf2969449087c97f4cbef7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a65f43a7b44bf2969449087c97f4cbef7">read_typed_block</a> (<a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a> addr, std::vector&lt; <a class="el" href="classturi_1_1flexible__type.html">flexible_type</a> &gt; &amp;ret, <a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> **ret_info=NULL)</td></tr>
<tr class="separator:a65f43a7b44bf2969449087c97f4cbef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a020083663247b96c249d21048f75ac31"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a020083663247b96c249d21048f75ac31">read_typed_blocks</a> (<a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a> addr, size_t nblocks, std::vector&lt; std::vector&lt; <a class="el" href="classturi_1_1flexible__type.html">flexible_type</a> &gt; &gt; &amp;ret, std::vector&lt; <a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> &gt; *ret_info=NULL)</td></tr>
<tr class="separator:a020083663247b96c249d21048f75ac31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af648a8e5798893040a137878c3294418"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:af648a8e5798893040a137878c3294418"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#af648a8e5798893040a137878c3294418">read_block</a> (<a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a> addr, std::vector&lt; T &gt; &amp;ret, <a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> **ret_info=NULL)</td></tr>
<tr class="separator:af648a8e5798893040a137878c3294418"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ac02f8f152c62afbed78e9466cf7a750d"><td class="memItemLeft" align="right" valign="top"><a id="ac02f8f152c62afbed78e9466cf7a750d"></a>
static <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html">block_manager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#ac02f8f152c62afbed78e9466cf7a750d">get_instance</a> ()</td></tr>
<tr class="memdesc:ac02f8f152c62afbed78e9466cf7a750d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get singleton instance. <br /></td></tr>
<tr class="separator:ac02f8f152c62afbed78e9466cf7a750d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides block reading capability in v2 segment files.</p>
<p>This class manages block reading of an SArray/SArray group , and provides functions to query the blocks (such has how many blocks are there in the segment, and how many rows are there in the block etc).</p>
<h2>Array Group </h2>
<p>An array group is a collection of segment files which contain and represent and collection of arrays (columns).</p>
<p>Essentially an Array Group comprises of the following:</p><ul>
<li>group.sidx the group index file. A JSON serialized contents of <a class="el" href="structturi_1_1group__index__file__information.html">group_index_file_information</a>. Describes a collection of arrays.</li>
<li>group.0000, group.0001, group.0002 Each file is one segment of the array group. (multiple segments in an array group really exist only for parallel writing (and appending) capabilities. On reading, the segment layout is inconsequential, and a logical partitioning across threads is used.)</li>
</ul>
<p>Each segment file internally then has the following layout (1) Consecutive Block contents, each block 4K aligned. (2) A direct serialization of a vector&lt;vector&lt;block_info&gt; &gt; (blocks[column_id][block_id]) (3) 8 bytes containing the file offset. at which (2) begins</p>
<p>For instance, if there are 2 segments with 3 columns each of 20 rows, we may get the following layout:</p>
<p>group.0001:</p><ul>
<li>column 0, block 0, 3 rows</li>
<li>column 1, block 0, 3 rows</li>
<li>column 2, block 0, 4 rows</li>
<li>column 0, block 1, 4 rows</li>
<li>column 0, block 2, 3 rows</li>
<li>column 1, block 1, 7 rows</li>
<li>column 2, block 1, 6 rows</li>
</ul>
<p>group.0002:</p><ul>
<li>column 1, block 0, 5 rows</li>
<li>column 0, block 0, 10 rows</li>
<li>column 1, block 1, 5 rows</li>
<li>column 2, block 0, 10 rows</li>
</ul>
<p>Observe the following: 1) Each segment contains the same number of rows from each column. (technically the format does not require this, but the writer will always produce this result) 2) Blocks can be of different sizes. (the <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html">block_manager</a> and <a class="el" href="classturi_1_1v2__block__impl_1_1block__writer.html">block_writer</a> do not have a block size constraint. The <a class="el" href="classturi_1_1sarray__group__format__writer__v2.html">sarray_group_format_writer_v2</a> tries to keep to a block size of SFRAME_DEFAULT_BLOCK_SIZE after compression, but this is done by performing block size estimation (#bytes written / #rows written). But the format itself does not care. 3) Blocks can be laid out in arbitrary order across columns. Striping of columns is unnecessary) 4) Within each segment, the blocks for a given column are consecutive.</p>
<h2>File Addressing </h2>
<p>Since an array group (and hence a segment) can contain multiple columns, we need a uniform way of addressing a particular column inside an array group, or inside a segment. Thus the following convention is used:</p>
<p>Given an array group of 3 columns comprising of the files:</p><ul>
<li>group.sidx</li>
<li>group.0000, group.0001, group.0002, group.0003</li>
</ul>
<p>Column 0 in the array group can be addressed by opening the index file "group.sidx:0". Similarly, column 2 can be addressed using "group.sidx:2"</p>
<p>Column 2 of the array group thus has the segment files:</p><ul>
<li>group.0000:2, group.0001:2, group.0002:2, group.0002:3</li>
</ul>
<p>By convention if "group.sidx" is opened as a single array, it refers to column 0.</p>
<h2>Block Manager </h2>
<p>The block manager is a singleton reader object that provides read access to columns. The usage convention is:</p><ul>
<li><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html">block_manager</a>&amp; manager = <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#ac02f8f152c62afbed78e9466cf7a750d" title="Get singleton instance. ">block_manager::get_instance()</a></li>
<li>column_address = manager.open_column("group.0000:2") // opens column 2 in segment</li>
<li>.. do stuff ..</li>
<li>manager.close_column(column_address) We will expand on .. do stuff .. below.</li>
</ul>
<p>The reason for having a singleton block manager is to provide better control over file handle utilization. Specifically, the block manager maintains a pool of file handles and will recycle file handles (close them until they are next needed, then reopen and seek) so as to avoid file handle usage exceeding a certain limit (as defined in DEFAULT_FILE_HANDLE_POOL_SIZE) Furthermore, the block manager can combine accesses of multiple columns in the same array group into a single file handle. Future performance improvements involving better IO scheduling can also be performed here.</p>
<p>When a column is opened by <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#ad2f22a722c480ce6f1f6e709d1cdf425">open_column()</a>, a <a class="el" href="namespaceturi_1_1v2__block__impl.html#a94d78bcd851eb06af0bf8129da9b5c3b">column_address</a> is returned. This is a pair of integers of {segment_file_id, and column_id}. column_id is the column within the segment. For instance, opening "group.0000:2" will have column_id = 2. The segment_file_id is an internal ID assigned by the block manager to track all accesses to the file group.0000. All open calls to group.0000 will return the same segment_file_id, and a reference counter is used internally to figure out when the file handle and block metadata can be released. <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a894aaa104dc1754a35df2d1ac6184944">close_column()</a> thus must be called for every call to <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#ad2f22a722c480ce6f1f6e709d1cdf425">open_column()</a>.</p>
<p>Once the column is opened, <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a8203a24889f963b966c94fd57b1bbbc9">num_blocks_in_column()</a> can be used to obtain the number of blocks in the segment file belonging to the column. <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a61af9c7af7d6fe9a746d4852e2370d24">read_block()</a> or <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a65f43a7b44bf2969449087c97f4cbef7">read_typed_block()</a> can then be used to read the blocks. These functions take a <a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a>, which is a triple of {segment_file_id, column_id, block_id}. The first 2 fields can be copied from the column_address, the block_id is a sequential counter from 0 to <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a8203a24889f963b966c94fd57b1bbbc9">num_blocks_in_column()</a> - 1. </p>

<p class="definition">Definition at line <a class="el" href="sarray__v2__block__manager_8hpp_source.html#l00155">155</a> of file <a class="el" href="sarray__v2__block__manager_8hpp_source.html">sarray_v2_block_manager.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a894aaa104dc1754a35df2d1ac6184944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a894aaa104dc1754a35df2d1ac6184944">&#9670;&nbsp;</a></span>close_column()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void turi::v2_block_impl::block_manager::close_column </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceturi_1_1v2__block__impl.html#a94d78bcd851eb06af0bf8129da9b5c3b">column_address</a>&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Releases the column opened with <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#ad2f22a722c480ce6f1f6e709d1cdf425">open_column()</a> </p>

</div>
</div>
<a id="a2676147bf68a5b4e4ea8cb00eaf56fdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2676147bf68a5b4e4ea8cb00eaf56fdb">&#9670;&nbsp;</a></span>get_all_block_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;std::vector&lt;<a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a>&gt; &gt;&amp; turi::v2_block_impl::block_manager::get_all_block_info </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>segment_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns all the blockinfo in a segment </p>

</div>
</div>
<a id="aeb0042d6368f838c248e04ef4ea8a5f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb0042d6368f838c248e04ef4ea8a5f6">&#9670;&nbsp;</a></span>get_block_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a>&amp; turi::v2_block_impl::block_manager::get_block_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a>&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the number of rows in a block Returns (size_t)(-1) on failure. </p>

</div>
</div>
<a id="a8203a24889f963b966c94fd57b1bbbc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8203a24889f963b966c94fd57b1bbbc9">&#9670;&nbsp;</a></span>num_blocks_in_column()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t turi::v2_block_impl::block_manager::num_blocks_in_column </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceturi_1_1v2__block__impl.html#a94d78bcd851eb06af0bf8129da9b5c3b">column_address</a>&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the number of blocks in this column of this segment. </p>

</div>
</div>
<a id="ad2f22a722c480ce6f1f6e709d1cdf425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2f22a722c480ce6f1f6e709d1cdf425">&#9670;&nbsp;</a></span>open_column()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceturi_1_1v2__block__impl.html#a94d78bcd851eb06af0bf8129da9b5c3b">column_address</a> turi::v2_block_impl::block_manager::open_column </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>column_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Opens a file of the form segment_file:column_number and returns the the column address: {segment_file_id, column_id}.</p>
<p>calling <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a8203a24889f963b966c94fd57b1bbbc9">num_blocks_in_column()</a> will return the number of blocks within this column, after which columns can be read by providing {segment_file_id, column_id, block_id} to <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a61af9c7af7d6fe9a746d4852e2370d24">read_block()</a></p>
<p><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#a894aaa104dc1754a35df2d1ac6184944">close_column()</a> must be called for each call to <a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html#ad2f22a722c480ce6f1f6e709d1cdf425">open_column()</a> </p>

</div>
</div>
<a id="a61af9c7af7d6fe9a746d4852e2370d24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61af9c7af7d6fe9a746d4852e2370d24">&#9670;&nbsp;</a></span>read_block() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;std::vector&lt;char&gt; &gt; turi::v2_block_impl::block_manager::read_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> **&#160;</td>
          <td class="paramname"><em>ret_info</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads a block as bytes a block address ((array_group ID, segment ID, block ID) tuple),</p>
<p>If info is not NULL, A pointer to the block information will be stored info *info. This is a pointer into internal datastructures of the block manager and should not be modified or freed.</p>
<p>Return an empty pointer on failure.</p>
<p>Safe for concurrent operation. </p>

</div>
</div>
<a id="af648a8e5798893040a137878c3294418"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af648a8e5798893040a137878c3294418">&#9670;&nbsp;</a></span>read_block() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool turi::v2_block_impl::block_manager::read_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> **&#160;</td>
          <td class="paramname"><em>ret_info</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reads a few blocks starting from a given a block address ((array_group ID, segment ID, block ID) tuple) and deserializes it into an array. The block Returns true on success, false on failure.</p>
<p>May return less than nblocks if addr goes past the last block.</p>
<p>Safe for concurrent operation. </p>

<p class="definition">Definition at line <a class="el" href="sarray__v2__block__manager_8hpp_source.html#l00247">247</a> of file <a class="el" href="sarray__v2__block__manager_8hpp_source.html">sarray_v2_block_manager.hpp</a>.</p>

</div>
</div>
<a id="a65f43a7b44bf2969449087c97f4cbef7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65f43a7b44bf2969449087c97f4cbef7">&#9670;&nbsp;</a></span>read_typed_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool turi::v2_block_impl::block_manager::read_typed_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classturi_1_1flexible__type.html">flexible_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> **&#160;</td>
          <td class="paramname"><em>ret_info</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads a block given a block address ((array_group ID, segment ID, block ID) tuple), into a typed array. The block must have been stored as a typed block. Returns true on success, false on failure.</p>
<p>Safe for concurrent operation. </p>

</div>
</div>
<a id="a020083663247b96c249d21048f75ac31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a020083663247b96c249d21048f75ac31">&#9670;&nbsp;</a></span>read_typed_blocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool turi::v2_block_impl::block_manager::read_typed_blocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceturi_1_1v2__block__impl.html#a9af1ff72afa8d032d0404e6b4622af98">block_address</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nblocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="classturi_1_1flexible__type.html">flexible_type</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structturi_1_1v2__block__impl_1_1block__info.html">block_info</a> &gt; *&#160;</td>
          <td class="paramname"><em>ret_info</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads a few blocks starting from a given a block address ((array_group ID, segment ID, block ID) tuple), into a typed array. The block must have been stored as a typed block. Returns true on success, false on failure.</p>
<p>May return less than nblocks if addr goes past the last block.</p>
<p>Safe for concurrent operation. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>core/storage/sframe_data/<a class="el" href="sarray__v2__block__manager_8hpp_source.html">sarray_v2_block_manager.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceturi.html">turi</a></li><li class="navelem"><a class="el" href="namespaceturi_1_1v2__block__impl.html">v2_block_impl</a></li><li class="navelem"><a class="el" href="classturi_1_1v2__block__impl_1_1block__manager.html">block_manager</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
