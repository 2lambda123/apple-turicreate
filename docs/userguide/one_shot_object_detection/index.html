
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>One-Shot Object Detection Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.0">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../style_transfer/" />
    
    
    <link rel="prev" href="../object_detection/how-it-works.html" />
    

    <script src="../turi/js/jquery/jquery-2.1.3.min.js"></script>
    <script src="../turi/js/d3/d3.min.js"></script>
    <script src="../supervised-learning/images/random-utils.js"></script>
    <script src="../supervised-learning/images/plotting-utils.js"></script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../sframe/">
            
                <a href="../sframe/">
            
                    
                    Working with data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../sframe/tabular-data.html">
            
                <a href="../sframe/tabular-data.html">
            
                    
                    Tabular data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../sframe/sframe-intro.html">
            
                <a href="../sframe/sframe-intro.html">
            
                    
                    Loading and Saving
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../sframe/data-manipulation.html">
            
                <a href="../sframe/data-manipulation.html">
            
                    
                    Data Manipulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../data_formats_and_sources/sql_integration.html">
            
                <a href="../data_formats_and_sources/sql_integration.html">
            
                    
                    SQL Databases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../sgraph/sgraph.html">
            
                <a href="../sgraph/sgraph.html">
            
                    
                    Graph data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../text/analysis.html">
            
                <a href="../text/analysis.html">
            
                    
                    Text data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../vis/">
            
                <a href="../vis/">
            
                    
                    Visualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../vis/gallery.html">
            
                <a href="../vis/gallery.html">
            
                    
                    Example Gallery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../vis/use_cases.html">
            
                <a href="../vis/use_cases.html">
            
                    
                    Sample Use Cases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../applications/">
            
                <a href="../applications/">
            
                    
                    Task focused toolkits
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../recommender/">
            
                <a href="../recommender/">
            
                    
                    Recommender Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../recommender/using-trained-models.html">
            
                <a href="../recommender/using-trained-models.html">
            
                    
                    Using models
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../recommender/choosing-a-model.html">
            
                <a href="../recommender/choosing-a-model.html">
            
                    
                    Choosing a model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../recommender/coreml-deployment.html">
            
                <a href="../recommender/coreml-deployment.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../image_classifier/">
            
                <a href="../image_classifier/">
            
                    
                    Image Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../image_classifier/advanced-usage.html">
            
                <a href="../image_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../image_classifier/how-it-works.html">
            
                <a href="../image_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../image_classifier/export-coreml.html">
            
                <a href="../image_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../drawing_classifier/">
            
                <a href="../drawing_classifier/">
            
                    
                    Drawing Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../drawing_classifier/how-it-works.html">
            
                <a href="../drawing_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../drawing_classifier/data-preparation.html">
            
                <a href="../drawing_classifier/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../drawing_classifier/export-coreml.html">
            
                <a href="../drawing_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../drawing_classifier/advanced-usage.html">
            
                <a href="../drawing_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../sound_classifier/">
            
                <a href="../sound_classifier/">
            
                    
                    Sound Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../sound_classifier/how-it-works.html">
            
                <a href="../sound_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../sound_classifier/advanced-usage.html">
            
                <a href="../sound_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="../sound_classifier/export-coreml.html">
            
                <a href="../sound_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../image_similarity/">
            
                <a href="../image_similarity/">
            
                    
                    Image Similarity
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="../image_similarity/export-coreml.html">
            
                <a href="../image_similarity/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../object_detection/">
            
                <a href="../object_detection/">
            
                    
                    Object Detection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1" data-path="../object_detection/data-preparation.html">
            
                <a href="../object_detection/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.2" data-path="../object_detection/advanced-usage.html">
            
                <a href="../object_detection/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.3" data-path="../object_detection/export-coreml.html">
            
                <a href="../object_detection/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.4" data-path="../object_detection/how-it-works.html">
            
                <a href="../object_detection/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.3.7" data-path="./">
            
                <a href="./">
            
                    
                    One-Shot Object Detection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../style_transfer/">
            
                <a href="../style_transfer/">
            
                    
                    Style Transfer
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.8.1" data-path="../style_transfer/how-it-works.html">
            
                <a href="../style_transfer/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8.2" data-path="../style_transfer/export-coreml.html">
            
                <a href="../style_transfer/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../activity_classifier/">
            
                <a href="../activity_classifier/">
            
                    
                    Activity Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.9.1" data-path="../activity_classifier/data-preparation.html">
            
                <a href="../activity_classifier/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.2" data-path="../activity_classifier/advanced-usage.html">
            
                <a href="../activity_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.3" data-path="../activity_classifier/export_coreml.html">
            
                <a href="../activity_classifier/export_coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.4" data-path="../activity_classifier/how-it-works.html">
            
                <a href="../activity_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../text_classifier/">
            
                <a href="../text_classifier/">
            
                    
                    Text Classifier
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../modeling-data/">
            
                <a href="../modeling-data/">
            
                    
                    Machine learning essentials
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../supervised-learning/classifier.html">
            
                <a href="../supervised-learning/classifier.html">
            
                    
                    Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../supervised-learning/boosted_trees_classifier.html">
            
                <a href="../supervised-learning/boosted_trees_classifier.html">
            
                    
                    Boosted Trees Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../supervised-learning/decision_tree_classifier.html">
            
                <a href="../supervised-learning/decision_tree_classifier.html">
            
                    
                    Decision Tree Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../supervised-learning/logistic-regression.html">
            
                <a href="../supervised-learning/logistic-regression.html">
            
                    
                    Logistic Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../supervised-learning/knn_classifier.html">
            
                <a href="../supervised-learning/knn_classifier.html">
            
                    
                    Nearest Neighbor Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="../supervised-learning/random_forest_classifier.html">
            
                <a href="../supervised-learning/random_forest_classifier.html">
            
                    
                    Random Forest Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.6" data-path="../supervised-learning/svm.html">
            
                <a href="../supervised-learning/svm.html">
            
                    
                    SVM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.7" data-path="../supervised-learning/export-coreml.html">
            
                <a href="../supervised-learning/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../clustering/">
            
                <a href="../clustering/">
            
                    
                    Clustering
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../clustering/kmeans.html">
            
                <a href="../clustering/kmeans.html">
            
                    
                    KMeans
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../clustering/dbscan.html">
            
                <a href="../clustering/dbscan.html">
            
                    
                    DBSCAN
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../graph_analytics/">
            
                <a href="../graph_analytics/">
            
                    
                    Graph analytics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../nearest_neighbors/nearest_neighbors.html">
            
                <a href="../nearest_neighbors/nearest_neighbors.html">
            
                    
                    Nearest neighbors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../supervised-learning/regression.html">
            
                <a href="../supervised-learning/regression.html">
            
                    
                    Regression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../supervised-learning/boosted_trees_regression.html">
            
                <a href="../supervised-learning/boosted_trees_regression.html">
            
                    
                    Boosted Trees Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.2" data-path="../supervised-learning/decision_tree_regression.html">
            
                <a href="../supervised-learning/decision_tree_regression.html">
            
                    
                    Decision Tree Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.3" data-path="../supervised-learning/linear-regression.html">
            
                <a href="../supervised-learning/linear-regression.html">
            
                    
                    Linear Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.4" data-path="../supervised-learning/random_forest_regression.html">
            
                <a href="../supervised-learning/random_forest_regression.html">
            
                    
                    Random Forest Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.5" data-path="../supervised-learning/export-coreml.html">
            
                <a href="../supervised-learning/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../text/">
            
                <a href="../text/">
            
                    
                    Text analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../evaluation/">
            
                <a href="../evaluation/">
            
                    
                    Evaluating models
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../evaluation/regression.html">
            
                <a href="../evaluation/regression.html">
            
                    
                    Regression metrics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../evaluation/classification.html">
            
                <a href="../evaluation/classification.html">
            
                    
                    Classification metrics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../conclusion.html">
            
                <a href="../conclusion.html">
            
                    
                    Additional Resources
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../cpp.html">
            
                <a href="../cpp.html">
            
                    
                    C++ API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../datasets.html">
            
                <a href="../datasets.html">
            
                    
                    Dataset Disclaimer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >One-Shot Object Detection</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="one-shot-object-detection"><a name="one-shot-object-detection" class="plugin-anchor" href="#one-shot-object-detection"><i class="fa fa-link" aria-hidden="true"></i></a>One-Shot Object Detection</h1><p>One-Shot object detection (OSOD) is the task of detecting an object from as little as <strong>one</strong> example per category. Unlike the <a href="https://apple.github.io/turicreate/docs/userguide/object_detection" target="_blank">Object Detector</a> which requires many varied examples of objects in the real world, the One-Shot Object Detector requires a very small (sometimes even just one) canonical example of the object. The One-shot Object Detector is best suited for two-dimensional objects that have some regularity in the wild. Examples include road signs, logos, playing cards, and clapperboards. The One-Shot Object Detector is not suitable for three-dimensional objects like faces, animals, and cars -- such objects are better suited for the classical <a href="https://apple.github.io/turicreate/docs/userguide/object_detection" target="_blank">Object Detector</a>.</p><h2 id="introductory-example"><a name="introductory-example" class="plugin-anchor" href="#introductory-example"><i class="fa fa-link" aria-hidden="true"></i></a>Introductory Example</h2><p>In this example, our goal is to <strong>localize</strong> instances of <strong>stop signs</strong> in images. To train a model for this application, we supply a single image of a stop sign as a starter image.</p><p>Given a starter image (<em>left</em>), a one-shot object detector trained on this starter image will produce instance predictions on a test image (<em>right</em>) which may look like this:</p><p><img alt="Stop Sign vector and prediction images" src="images/stop_sign_sample.jpg"></p><p>Download the <a href="images/stop_sign_starter.png">stop_sign_starter.png</a> image. Also Download <a href="images/stop_sign_test1.jpg">stop_sign_test1.jpg</a> and <a href="images/stop_sign_test2.jpg">stop_sign_test2.jpg</a></p><pre><code class="lang-python"><span class="hljs-keyword">import</span> turicreate <span class="hljs-keyword">as</span> tc

<span class="hljs-comment"># Load the starter images</span>
starter_images = tc.SFrame({<span class="hljs-string">&apos;image&apos;</span>:[tc.Image(<span class="hljs-string">&apos;stop_sign_starter.png&apos;</span>)],
                   <span class="hljs-string">&apos;label&apos;</span>:[<span class="hljs-string">&apos;stop_sign&apos;</span>]})

<span class="hljs-comment"># Load test images</span>
test_images = tc.SFrame({<span class="hljs-string">&apos;image&apos;</span>:[tc.Image(<span class="hljs-string">&apos;stop_sign_test1.jpg&apos;</span>), 
                                  tc.Image(<span class="hljs-string">&apos;stop_sign_test2.jpg&apos;</span>)]})

<span class="hljs-comment"># Create a model. This step will take a few hours on CPU and about an hour on GPU</span>
model = tc.one_shot_object_detector.create(starter_images, <span class="hljs-string">&apos;label&apos;</span>)

<span class="hljs-comment"># Save predictions on the test set</span>
test_images[<span class="hljs-string">&apos;predictions&apos;</span>] = model.predict(test_images)

<span class="hljs-comment"># Draw prediction bounding boxes on the test images</span>
test_images[<span class="hljs-string">&apos;annotated_predictions&apos;</span>] = \
    tc.one_shot_object_detector.util.draw_bounding_boxes(test_images[<span class="hljs-string">&apos;image&apos;</span>],
        test_images[<span class="hljs-string">&apos;predictions&apos;</span>]) 

<span class="hljs-comment"># To visualize the predictions made on the test set</span>
test_images.explore()

<span class="hljs-comment"># Save the model for later use in TuriCreate</span>
model.save(<span class="hljs-string">&apos;stop-sign.model&apos;</span>)

<span class="hljs-comment"># Export for use in Core ML</span>
model.export_coreml(<span class="hljs-string">&apos;MyCustomOneShotDetector.mlmodel&apos;</span>)</code></pre>
<p>Examples of test image predictions:</p><p><img alt="Sample prediction image - 1 and 2" src="images/sample_prediction_images_1_2.jpg"></p><h2 id="deployment-to-coreml"><a name="deployment-to-coreml" class="plugin-anchor" href="#deployment-to-coreml"><i class="fa fa-link" aria-hidden="true"></i></a>Deployment to CoreML</h2><p>To learn more about deploying One-Shot to CoreML details, refer to the <a href="https://apple.github.io/turicreate/docs/userguide/object_detection/export-coreml.html" target="_blank">Object Detector: Deployment to Core ML</a> chapter.</p><h2 id="how-it-works"><a name="how-it-works" class="plugin-anchor" href="#how-it-works"><i class="fa fa-link" aria-hidden="true"></i></a>How it works</h2><p>In this section, we will go into detail on what happens under the hood of the <code>create</code> method. A One-Shot Object Detector model is trained in two steps. First, the starter image(s) is used to generate synthetic data and annotations. Second, we train an object detector model on the generated synthetic data.</p><p><strong>Stage 1: Automatic synthetic data generation</strong></p><p>To begin training, the provided starter image(s) are used to generate a set of synthetic training data. 
The synthetic images are generated by applying yaw, pitch, and roll rotations on a set of background images. If no background images are provided, a set of default background images are automatically downloaded and used.</p><p><strong>Stage 2: Train the Object Detector model</strong></p><p>To learn about the training implementation details, refer to the <a href="https://apple.github.io/turicreate/docs/userguide/object_detection/how-it-works.html" target="_blank">Object Detector: How it Works</a> chapter.</p><h2 id="troubleshooting"><a name="troubleshooting" class="plugin-anchor" href="#troubleshooting"><i class="fa fa-link" aria-hidden="true"></i></a>Troubleshooting</h2><p>Here is a collection of some known caveats and their respective workarounds while using One-Shot Object Detection.</p><h5 id="my-starter-image-can-appear-upside-down-as-well-as-rotated-90-degrees-in-the-wild-is-there-anything-i-can-do-to-improve-the-quality-of-the-model"><a name="my-starter-image-can-appear-upside-down-as-well-as-rotated-90-degrees-in-the-wild-is-there-anything-i-can-do-to-improve-the-quality-of-the-model" class="plugin-anchor" href="#my-starter-image-can-appear-upside-down-as-well-as-rotated-90-degrees-in-the-wild-is-there-anything-i-can-do-to-improve-the-quality-of-the-model"><i class="fa fa-link" aria-hidden="true"></i></a>My starter image can appear upside down as well as rotated 90 degrees in the wild. Is there anything I can do to improve the quality of the model?</h5><p>To ensure a higher quality model, instead of providing <em>one</em> starter image, feel free to provide <em>more than one</em> starter images. For every starter image, we rotate the starter image by up to 20 degrees. As a result, to detect both inverted and erect projections of the same starter image, you can provide <em>2</em> starter images with the same label. Here is an example to rotate a Stop Sign starter image by 90 degrees, 180 degrees, and 270 degrees, and construct an SFrame with four starter images:</p><pre><code class="lang-python"><span class="hljs-keyword">import</span> turicreate <span class="hljs-keyword">as</span> tc

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pil_to_tc</span><span class="hljs-params">(pil_image)</span>:</span>
    pixel_data = np.array(pil_image)
    FORMAT_RAW = <span class="hljs-number">2</span>
    <span class="hljs-keyword">return</span> tc.Image(_image_data=pixel_data.tobytes(),
                    _width=pixel_data.shape[<span class="hljs-number">1</span>],
                    _height=pixel_data.shape[<span class="hljs-number">0</span>],
                    _channels=pixel_data.shape[<span class="hljs-number">2</span>],
                    _format_enum=FORMAT_RAW,
                    _image_data_size=pixel_data.size)

image_path = <span class="hljs-comment"># set image path here</span>
tc_image = tc.Image(image_path)
pil_image = Image.open(image_path)
images = [tc_image]
<span class="hljs-keyword">for</span> rotation_angle <span class="hljs-keyword">in</span> [<span class="hljs-number">90</span>, <span class="hljs-number">180</span>, <span class="hljs-number">270</span>]:
    rotated = pil_to_tc(pil_image.rotate(rotation_angle, expand=<span class="hljs-keyword">True</span>))
    images.append(rotated)

starter_images = tc.SFrame({
    <span class="hljs-string">&apos;image&apos;</span>: images,
    <span class="hljs-string">&apos;label&apos;</span>: [<span class="hljs-string">&apos;my_label&apos;</span>] * <span class="hljs-number">4</span>
})</code></pre>
<h5 id="while-training-with-the-default-backgrounds-my-starter-image-does-not-appear-in-most-of-the-images-in-the-synthetic-data"><a name="while-training-with-the-default-backgrounds-my-starter-image-does-not-appear-in-most-of-the-images-in-the-synthetic-data" class="plugin-anchor" href="#while-training-with-the-default-backgrounds-my-starter-image-does-not-appear-in-most-of-the-images-in-the-synthetic-data"><i class="fa fa-link" aria-hidden="true"></i></a>While training with the default backgrounds, my starter image does not appear in most of the images in the synthetic data.</h5><p>This is a known issue (<a href="https://github.com/apple/turicreate/issues/2341" target="_blank">#2341</a>) that we&apos;re trying to fix. As a workaround, please try resizing your starter image (while preserving the aspect ratio of the starter image) to get it as close to <code>500x500</code> (for the default backgrounds) as possible. You can leverage the following API provided by <code>turicreate.Image</code>:</p><pre><code class="lang-python">image = turicreate.Image(<span class="hljs-string">&apos;starter.png&apos;</span>)
turicreate.image_analysis.resize(image, width=image.width//<span class="hljs-number">2</span>, height=image.height//<span class="hljs-number">2</span>, channels=image.channels)</code></pre>
<h2 id="advanced-usage"><a name="advanced-usage" class="plugin-anchor" href="#advanced-usage"><i class="fa fa-link" aria-hidden="true"></i></a>Advanced Usage</h2><h3 id="background-images"><a name="background-images" class="plugin-anchor" href="#background-images"><i class="fa fa-link" aria-hidden="true"></i></a>Background Images</h3><p>You can preview the synthetic images the toolkit generates by calling the <code>preview_synthetic_training_data</code> utility. This helps you understand data the model would be trained on:</p><pre><code class="lang-python">synthetic_images = \
tc.one_shot_object_detector.util.preview_synthetic_training_data(starter_images, <span class="hljs-string">&apos;label&apos;</span>)

synthetic_images.explore()</code></pre>
<p><img alt="Explore synthetic images" src="images/synthetic_images_explore.jpg"></p><p>Some examples of synthetic training data:</p><p><img alt="Sample synthetic images" src="images/synthetic_images_collage.jpg"></p><p><em>Note: In order to view the exact synthetic images used to train the model, the same seed should be used which was used to train the model.</em></p><p>While we provide a set of background images by default, you can use your own custom background images (specific to your application) as follows:</p><pre><code class="lang-python"><span class="hljs-comment"># Load background images</span>
my_backgrounds = tc.SArray(<span class="hljs-string">&apos;my_custom_backgrounds.sarray&apos;</span>)

<span class="hljs-comment"># Create a model using custom background images                                    </span>
model = tc.one_shot_object_detector.create(starter_images, <span class="hljs-string">&apos;label&apos;</span>, backgrounds=my_backgrounds)</code></pre>
<p>To preview the synthetic images generated with your custom background images:</p><pre><code class="lang-python">synthetic_images = \
tc.one_shot_object_detector.util.preview_synthetic_training_data(starter_images, <span class="hljs-string">&apos;label&apos;</span>, my_backgrounds)</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../object_detection/how-it-works.html" class="navigation navigation-prev " aria-label="Previous page: How it works">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../style_transfer/" class="navigation navigation-next " aria-label="Next page: Style Transfer">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"One-Shot Object Detection","level":"1.3.7","depth":2,"next":{"title":"Style Transfer","level":"1.3.8","depth":2,"path":"style_transfer/README.md","ref":"style_transfer/README.md","articles":[{"title":"How it works","level":"1.3.8.1","depth":3,"path":"style_transfer/how-it-works.md","ref":"style_transfer/how-it-works.md","articles":[]},{"title":"Deployment to Core ML","level":"1.3.8.2","depth":3,"path":"style_transfer/export-coreml.md","ref":"style_transfer/export-coreml.md","articles":[]}]},"previous":{"title":"How it works","level":"1.3.6.4","depth":3,"path":"object_detection/how-it-works.md","ref":"object_detection/how-it-works.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"3.2.0","theme":"default","variables":{},"plugins":["collapsible-menu@1.0.2","anchors@0.5.0","mathjax"],"pluginsConfig":{"collapsible-menu":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"fontSettings":{"theme":"white","family":"sans","size":2},"highlight":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"one_shot_object_detection/README.md","mtime":"2020-04-18T04:35:02.798Z","type":"markdown"},"gitbook":{"version":"3.2.0","time":"2020-04-27T22:57:55.586Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

